<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم AIMHACK - إدارة المنتجات والكوبونات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #0a0a0a;
            --panel: #111112;
            --card: #1a1a1d;
            --accent: #ff2a2a;
            --accent-light: #ff4d4d;
            --accent-dark: #cc0000;
            --success: #00cc66;
            --warning: #ffaa00;
            --info: #3399ff;
            --text: #ffffff;
            --text-muted: #b3b3b3;
            --border: #333336;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(255, 42, 42, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 42, 42, 0.05) 0%, transparent 50%);
            min-height: 100vh;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        .admin-header {
            background: linear-gradient(135deg, var(--panel) 0%, #1a1a1a 100%);
            padding: 25px 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 8px 32px rgba(255, 42, 42, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .admin-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
        }
        
        .admin-header h1 {
            color: var(--text);
            font-size: 32px;
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .admin-header h1 i {
            color: var(--accent);
            font-size: 28px;
        }
        
        .admin-subtitle {
            color: var(--text-muted);
            font-size: 16px;
            margin-left: 45px;
        }
        
        .admin-nav {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .admin-nav button {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 42, 42, 0.3);
        }
        
        .admin-nav button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 42, 42, 0.4);
        }
        
        /* Tab Styles */
        .tab-container {
            display: flex;
            gap: 5px;
            margin-bottom: 30px;
            background: var(--panel);
            padding: 8px;
            border-radius: 16px;
            border: 1px solid var(--border);
        }
        
        .tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            justify-content: center;
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 42, 42, 0.3);
        }
        
        .tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Stats Container */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, var(--card) 0%, #222225 100%);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 42, 42, 0.15);
        }
        
        .stat-card h3 {
            font-size: 36px;
            color: var(--accent);
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .stat-card p {
            color: var(--text-muted);
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Admin Content */
        .admin-content {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 25px;
        }
        
        .admin-panel {
            background: linear-gradient(135deg, var(--panel) 0%, #1a1a1a 100%);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .admin-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
            border-radius: 20px 20px 0 0;
        }
        
        .admin-panel h2 {
            margin-bottom: 25px;
            color: var(--text);
            font-size: 24px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .admin-panel h2 i {
            color: var(--accent);
            font-size: 22px;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }
        
        .form-control {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 42, 42, 0.1);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(255, 42, 42, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 42, 42, 0.4);
        }
        
        /* Lists */
        .products-list, .coupons-list {
            display: grid;
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .products-list::-webkit-scrollbar,
        .coupons-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .products-list::-webkit-scrollbar-track,
        .coupons-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .products-list::-webkit-scrollbar-thumb,
        .coupons-list::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 10px;
        }
        
        /* Cards */
        .product-card, .coupon-card {
            background: linear-gradient(135deg, var(--card) 0%, #222225 100%);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .product-card:hover, .coupon-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 42, 42, 0.15);
            border-color: rgba(255, 42, 42, 0.3);
        }
        
        .product-card {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .product-card img {
            width: 80px;
            height: 70px;
            object-fit: cover;
            border-radius: 12px;
            border: 2px solid var(--border);
        }
        
        .product-info {
            flex: 1;
        }
        
        .product-info h3 {
            margin-bottom: 8px;
            color: var(--text);
            font-size: 16px;
        }
        
        .product-info p {
            color: var(--text-muted);
            font-size: 14px;
            display: flex;
            gap: 15px;
        }
        
        .price-old {
            text-decoration: line-through;
            color: var(--text-muted);
        }
        
        .price-new {
            color: var(--accent);
            font-weight: 700;
        }
        
        /* Coupon Styles */
        .coupon-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .coupon-code {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent);
        }
        
        .coupon-discount {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
        }
        
        .coupon-details {
            display: flex;
            gap: 20px;
            color: var(--text-muted);
            font-size: 14px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .coupon-stats {
            display: flex;
            gap: 25px;
            margin: 15px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 5px;
        }
        
        /* Status Badges */
        .coupon-status {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
        }
        
        .status-active {
            background: rgba(0, 204, 102, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }
        
        .status-expired {
            background: rgba(255, 42, 42, 0.2);
            color: var(--accent);
            border: 1px solid var(--accent);
        }
        
        .status-inactive {
            background: rgba(179, 179, 179, 0.2);
            color: var(--text-muted);
            border: 1px solid var(--text-muted);
        }
        
        /* Action Buttons */
        .product-actions, .coupon-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-edit {
            background: linear-gradient(135deg, var(--info) 0%, #0066cc 100%);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .btn-edit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(51, 153, 255, 0.3);
        }
        
        .btn-delete {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .btn-delete:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 42, 42, 0.3);
        }
        
        /* Alerts */
        .alert {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .alert-success {
            border-color: var(--success);
            color: var(--success);
        }
        
        .alert-error {
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .alert-warning {
            border-color: var(--warning);
            color: var(--warning);
        }
        
        /* Login Screen */
        .login-container {
            max-width: 450px;
            margin: 100px auto;
            background: linear-gradient(135deg, var(--panel) 0%, #1a1a1a 100%);
            padding: 50px;
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 20px 60px rgba(255, 42, 42, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
        }
        
        .login-container h2 {
            text-align: center;
            margin-bottom: 35px;
            color: var(--text);
            font-size: 28px;
        }
        
        /* Utility Classes */
        .hidden {
            display: none;
        }
        
        .edit-mode {
            border: 2px solid var(--info);
            box-shadow: 0 0 0 3px rgba(51, 153, 255, 0.1);
        }
        
        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }
        
        .form-actions button {
            flex: 1;
        }
        
        .btn-cancel {
            background: transparent;
            color: var(--text-muted);
            border: 2px solid var(--border);
            padding: 16px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-cancel:hover {
            background: var(--border);
            color: var(--text);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .admin-content {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .tab-container {
                flex-direction: column;
            }
            
            .coupon-details {
                flex-direction: column;
                gap: 8px;
            }
            
            .coupon-stats {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .admin-header {
                padding: 20px;
            }
            
            .admin-header h1 {
                font-size: 24px;
            }
        }
        /* إضافة لون مميز لمنتجات DV ZOON */
.product-card[data-category="dvzoon"] {
    border-left: 4px solid #ff6b35;
}

.product-card[data-category="dvzoon"]:hover {
    border-color: #ff6b35;
    box-shadow: 0 8px 25px rgba(255, 107, 53, 0.15);
}

    </style>
</head>
<body>
    <!-- شاشة تسجيل الدخول -->
    <div id="loginScreen" class="login-container">
        <h2><i class="fas fa-lock"></i> تسجيل الدخول للإدارة</h2>
        <div class="form-group">
            <label for="adminEmail">البريد الإلكتروني</label>
            <input type="email" id="adminEmail" class="form-control" placeholder="admin@aimhack.com">
        </div>
        <div class="form-group">
            <label for="adminPassword">كلمة المرور</label>
            <input type="password" id="adminPassword" class="form-control" placeholder="********">
        </div>
        <button id="loginBtn" class="btn-primary">
            <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
        </button>
        <div id="loginAlert" class="alert alert-error hidden"></div>
    </div>
    
    <!-- لوحة التحكم الرئيسية -->
    <div id="adminPanel" class="admin-container hidden">
        <div class="admin-header">
            <h1><i class="fas fa-crown"></i> لوحة تحكم AIMHACK</h1>
            <div class="admin-subtitle">إدارة متكاملة للمنتجات وعروض الخصم</div>
            <div class="admin-nav">
                <button id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                </button>
            </div>
        </div>
        
<!-- التبويبات -->
<div class="tab-container">
    <button class="tab active" onclick="switchTab('products')">
        <i class="fas fa-boxes"></i> إدارة المنتجات
    </button>
    <button class="tab" onclick="switchTab('coupons')">
        <i class="fas fa-tags"></i> كوبونات الخصم
    </button>
    <button class="tab" onclick="switchTab('payment')">
        <i class="fas fa-money-bill-wave"></i> أرقام الدفع
    </button>
    <button class="tab" onclick="switchTab('stats')">
        <i class="fas fa-chart-bar"></i> التقارير والإحصائيات
    </button>
</div>

        <!-- قسم المنتجات -->
        <div id="products-tab" class="tab-content active">
            <div class="stats-container">
                <div class="stat-card">
                    <h3 id="totalProducts">0</h3>
                    <p>إجمالي المنتجات</p>
                </div>
                <div class="stat-card">
                    <h3 id="iosProducts">0</h3>
                    <p>منتجات iOS</p>
                </div>
                <div class="stat-card">
                    <h3 id="androidProducts">0</h3>
                    <p>منتجات Android</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalRevenue">0</h3>
                    <p>إجمالي الإيرادات</p>
                </div>
                <div class="stat-card">
                    <h3 id="dvzoonProducts">0</h3> <!-- أضف هذا -->
                    <p>منتجات DV ZOON</p>
                </div>
            </div>
            
            
            <div id="alertContainer"></div>
            
            <div class="admin-content">
                <div class="admin-panel" id="productFormPanel">
                    <h2><i class="fas fa-plus-circle"></i> <span id="formTitle">إضافة منتج جديد</span></h2>
                    <form id="productForm">
                        <input type="hidden" id="productId">
                        
                        <div class="form-group">
                            <label for="productTitle">اسم المنتج</label>
                            <input type="text" id="productTitle" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="productCategory">الفئة</label>
                            <select id="productCategory" class="form-control" required>
                                <option value="">اختر الفئة</option>
                                <option value="ios">iOS</option>
                                <option value="android">Android</option>
                                <option value="emulator">Emulator</option>
                                <option value="optimize">Optimize</option>
                                <option value="dvzoon">DV ZOON</option> 
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productOldPrice">السعر القديم (جنيه)</label>
                            <input type="number" id="productOldPrice" class="form-control" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="productPrice">السعر الحالي (جنيه)</label>
                            <input type="number" id="productPrice" class="form-control" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="productImage">رابط الصورة</label>
                            <input type="text" id="productImage" class="form-control" placeholder="https://example.com/image.jpg" required>
                        </div>
                        <!-- بعد حقل الصورة - أضف هذه الحقول الجديدة -->

<div class="form-group">
    <label for="productDescription">وصف المنتج</label>
    <textarea id="productDescription" class="form-control" rows="4" placeholder="وصف تفصيلي عن المنتج..."></textarea>
</div>

<div class="form-group">
    <label for="productVideo">رابط فيديو اليوتيوب</label>
    <input type="url" id="productVideo" class="form-control" placeholder="https://youtube.com/embed/...">
</div>

<div class="form-group">
    <label for="productFeatures">المميزات (كل ميزة في سطر)</label>
    <textarea id="productFeatures" class="form-control" rows="3" placeholder="ميزة 1&#10;ميزة 2&#10;ميزة 3"></textarea>
</div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn-primary" id="submitBtn">
                                <i class="fas fa-plus-circle"></i> إضافة المنتج
                            </button>
                            <button type="button" class="btn-cancel hidden" id="cancelEditBtn">
                                <i class="fas fa-times"></i> إلغاء
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="admin-panel">
                    <h2><i class="fas fa-boxes"></i> المنتجات الحالية</h2>
                    <div id="productsList" class="products-list">
                        <!-- سيتم ملء المنتجات هنا -->
                    </div>
                </div>
            </div>
        </div>
        
                      <!-- قسم أرقام الدفع -->
        <div id="payment-tab" class="tab-content">
            <div class="stats-container">
                <div class="stat-card">
                    <h3 id="binanceNumber">01064061942</h3>
                    <p>رقم Binance</p>
                </div>
                <div class="stat-card">
                    <h3 id="vodafoneNumber">01064061942</h3>
                    <p>رقم Vodafone Cash</p>
                </div>
                <div class="stat-card">
                    <h3 id="freefireNumber">4587554173</h3>
                    <p>رقم Free Fire ID</p>
                </div>
                <div class="stat-card">
                    <h3 id="whatsappNumber">201064061942</h3>
                    <p>رقم الواتساب</p>
                </div>
            </div>
            
            <div class="admin-content">
                <div class="admin-panel">
                    <h2><i class="fas fa-edit"></i> تعديل أرقام الدفع</h2>
                    <form id="paymentForm">
                        <div class="form-group">
                            <label for="binanceInput">رقم Binance</label>
                            <input type="text" id="binanceInput" class="form-control" placeholder="أدخل رقم Binance" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="vodafoneInput">رقم Vodafone Cash</label>
                            <input type="text" id="vodafoneInput" class="form-control" placeholder="أدخل رقم Vodafone Cash" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="freefireInput">رقم Free Fire ID</label>
                            <input type="text" id="freefireInput" class="form-control" placeholder="أدخل رقم Free Fire ID" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="whatsappInput">رقم الواتساب</label>
                            <input type="text" id="whatsappInput" class="form-control" placeholder="أدخل رقم الواتساب" required>
                        </div>
                        
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> حفظ التغييرات
                        </button>
                    </form>
                </div>
                
                <div class="admin-panel">
                    <h2><i class="fas fa-info-circle"></i> تعليمات الاستخدام</h2>
                    <div style="color: var(--text-muted); line-height: 1.8;">
                        <p><strong>ملاحظات هامة:</strong></p>
                        <ul style="margin: 15px 0; padding-right: 20px;">
                            <li>سيتم تحديث الأرقام في جميع صفحات الدفع تلقائياً</li>
                            <li>تأكد من صحة الأرقام قبل الحفظ</li>
                            <li>الأرقام الجديدة ستعمل فوراً بعد الحفظ</li>
                            <li>يمكنك تعديل الأرقام في أي وقت</li>
                        </ul>
                        
                        <p><strong>صفحات الدفع المتأثرة:</strong></p>
                        <ul style="margin: 15px 0; padding-right: 20px;">
                            <li>final_binance.html - صفحة دفع Binance</li>
                            <li>final_vodafone.html - صفحة دفع Vodafone Cash</li>
                            <li>final_gems.html - صفحة دفع Free Fire</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- قسم كوبونات الخصم -->
        <div id="coupons-tab" class="tab-content">
            <div class="stats-container">
                <div class="stat-card">
                    <h3 id="totalCoupons">0</h3>
                    <p>إجمالي الكوبونات</p>
                </div>
                <div class="stat-card">
                    <h3 id="activeCoupons">0</h3>
                    <p>كوبونات نشطة</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalUsage">0</h3>
                    <p>إجمالي مرات الاستخدام</p>
                </div>
                <div class="stat-card">
                    <h3 id="savingsAmount">0</h3>
                    <p>إجمالي التوفير</p>
                </div>
            </div>
            

        
            <div class="admin-content">
                <div class="admin-panel">
                    <h2><i class="fas fa-gift"></i> إنشاء كوبون جديد</h2>
                    <form id="couponForm">
                        <div class="form-group">
                            <label for="couponCode">كود الكوبون</label>
                            <input type="text" id="couponCode" class="form-control" required placeholder="مثال: SUMMER30">
                        </div>
                        
                        <div class="form-group">
                            <label for="discountType">نوع الخصم</label>
                            <select id="discountType" class="form-control" required>
                                <option value="percent">نسبة مئوية %</option>
                                <option value="fixed">مبلغ ثابت</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="discountValue">قيمة الخصم</label>
                            <input type="number" id="discountValue" class="form-control" required min="1" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label for="usageLimit">الحد الأقصى للاستخدام (اتركه فارغاً لاستخدام غير محدود)</label>
                            <input type="number" id="usageLimit" class="form-control" min="1" placeholder="غير محدود">
                        </div>
                        
                        <div class="form-group">
                            <label for="startDate">تاريخ البدء</label>
                            <input type="datetime-local" id="startDate" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="endDate">تاريخ الانتهاء</label>
                            <input type="datetime-local" id="endDate" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="isActive" checked> كوبون نشط
                            </label>
                        </div>
                        
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-plus"></i> إنشاء الكوبون
                        </button>
                    </form>
                </div>
                
                <div class="admin-panel">
                    <h2><i class="fas fa-list-alt"></i> الكوبونات الحالية</h2>
                    <div id="couponsList" class="coupons-list">
                        <!-- سيتم ملء الكوبونات هنا -->
                    </div>
                </div>
            </div>
        </div>
        
<div id="stats-tab" class="tab-content">
    <div class="stats-container">
        <div class="stat-card">
            <h3 id="statsTotalProducts">0</h3>
            <p>إجمالي المنتجات</p>
        </div>
        <div class="stat-card">
            <h3 id="statsTotalCoupons">0</h3>
            <p>إجمالي الكوبونات</p>
        </div>
        <div class="stat-card">
            <h3 id="statsTotalUsage">0</h3>
            <p>إجمالي مرات الاستخدام</p>
        </div>
        <div class="stat-card">
            <h3 id="statsDvzoonProducts">0</h3> <!-- أضف هذا -->
            <p>منتجات DV ZOON</p>
        </div>
    </div>
    
    <div class="admin-panel">
        <h2><i class="fas fa-chart-line"></i> إحصائيات الاستخدام</h2>
        <div id="usageStats" style="color: var(--text-muted); padding: 20px; text-align: center;">
            <p>جاري تحميل الإحصائيات...</p>
        </div>
    </div>
</div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script>
        // تهيئة Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAd5KNh5H6KaQ9nv8FP3keyFRh28zSwfLM",
            authDomain: "gama-xiter.firebaseapp.com",
            projectId: "gama-xiter",
            storageBucket: "gama-xiter.firebasestorage.app",
            messagingSenderId: "979348178199",
            appId: "1:979348178199:web:dd66b3d0d00b76fe61a352",
            measurementId: "G-4Q4P3GTJN5"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // عناصر DOM
        const loginScreen = document.getElementById('loginScreen');
        const adminPanel = document.getElementById('adminPanel');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const productForm = document.getElementById('productForm');
        const productsList = document.getElementById('productsList');
        const alertContainer = document.getElementById('alertContainer');
        const loginAlert = document.getElementById('loginAlert');
        const formTitle = document.getElementById('formTitle');
        const submitBtn = document.getElementById('submitBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const productFormPanel = document.getElementById('productFormPanel');
        
        // عناصر الإحصائيات
        const totalProductsEl = document.getElementById('totalProducts');
        const iosProductsEl = document.getElementById('iosProducts');
        const androidProductsEl = document.getElementById('androidProducts');
        
        // عناصر النموذج
        const productIdInput = document.getElementById('productId');
        const productTitleInput = document.getElementById('productTitle');
        const productCategoryInput = document.getElementById('productCategory');
        const productOldPriceInput = document.getElementById('productOldPrice');
        const productPriceInput = document.getElementById('productPrice');
        const productImageInput = document.getElementById('productImage');
        
        // حالة التعديل
        let isEditMode = false;
        let currentEditId = null;
        
        // التحقق من حالة تسجيل الدخول
        auth.onAuthStateChanged(user => {
            if (user) {
                loginScreen.classList.add('hidden');
                adminPanel.classList.remove('hidden');
                loadProducts();
                loadCoupons();
            } else {
                loginScreen.classList.remove('hidden');
                adminPanel.classList.add('hidden');
            }
        });
        
        // تسجيل الدخول
        loginBtn.addEventListener('click', () => {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    showAlert('تم تسجيل الدخول بنجاح', 'success');
                })
                .catch(error => {
                    loginAlert.textContent = 'خطأ في البريد الإلكتروني أو كلمة المرور';
                    loginAlert.classList.remove('hidden');
                });
        });
        
        // تسجيل الخروج
        logoutBtn.addEventListener('click', () => {
            auth.signOut();
        });
        
    // إضافة أو تعديل منتج
productForm.addEventListener('submit', e => {
    e.preventDefault();
    
    const title = productTitleInput.value;
    const category = productCategoryInput.value;
    const oldPrice = productOldPriceInput.value;
    const price = productPriceInput.value;
    const image = productImageInput.value;
    
    // الحقول الجديدة
    const description = document.getElementById('productDescription').value;
    const video = document.getElementById('productVideo').value;
    const features = document.getElementById('productFeatures').value.split('\n').filter(f => f.trim());
    
    if (isEditMode) {
        db.collection('products').doc(currentEditId).update({
            title: title,
            cat: category,
            old: oldPrice,
            price: price,
            img: image,
            description: description,    // الجديد
            video: video,               // الجديد
            features: features          // الجديد
        })
        .then(() => {
            showAlert('تم تحديث المنتج بنجاح', 'success');
            resetForm();
            loadProducts();
        })
        .catch(error => {
            showAlert('حدث خطأ أثناء تحديث المنتج', 'error');
            console.error('Error updating product:', error);
        });
    } else {
        const id = Date.now().toString();
        
        db.collection('products').doc(id).set({
            id: id,
            title: title,
            cat: category,
            old: oldPrice,
            price: price,
            img: image,
            description: description,    // الجديد
            video: video,               // الجديد
            features: features          // الجديد
        })
        .then(() => {
            showAlert('تم إضافة المنتج بنجاح', 'success');
            productForm.reset();
            loadProducts();
        })
        .catch(error => {
            showAlert('حدث خطأ أثناء إضافة المنتج', 'error');
            console.error('Error adding product:', error);
        });
    }
});
        
        // تحميل المنتجات من Firestore
function loadProducts() {
    productsList.innerHTML = '<div class="alert alert-warning">جاري تحميل المنتجات...</div>';
    
    db.collection('products').orderBy('id', 'desc').get()
        .then(querySnapshot => {
            productsList.innerHTML = '';
            
            if (querySnapshot.empty) {
                productsList.innerHTML = '<div class="alert alert-warning">لا توجد منتجات مضافة بعد</div>';
                updateStats(0, 0, 0, 0); // تحديث هنا
                return;
            }
            
            let total = 0;
            let iosCount = 0;
            let androidCount = 0;
            let dvzoonCount = 0; // أضف هذا
            
            querySnapshot.forEach(doc => {
                const product = doc.data();
                displayProduct(product);
                
                total++;
                if (product.cat === 'ios') iosCount++;
                if (product.cat === 'android') androidCount++;
                if (product.cat === 'dvzoon') dvzoonCount++; // أضف هذا
            });
            
            updateStats(total, iosCount, androidCount, dvzoonCount); // تحديث هنا
        })
        .catch(error => {
            console.error('Error loading products:', error);
            productsList.innerHTML = '<div class="alert alert-error">حدث خطأ في تحميل المنتجات</div>';
        });
}
        
        // عرض المنتج في القائمة
        function displayProduct(product) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.id = `product-${product.id}`;
            productCard.setAttribute('data-category', product.cat);

            productCard.innerHTML = `
                <img src="${product.img}" alt="${product.title}" onerror="this.src='https://via.placeholder.com/80x70/1a1a1d/ffffff?text=NO+IMAGE'">
                <div class="product-info">
                    <h3>${product.title}</h3>
                    <p>
                        <span class="category">${product.cat.toUpperCase()}</span>
                        <span class="price-old">${product.old} L.E</span>
                        <span class="price-new">${product.price} L.E</span>
                    </p>
                </div>
                <div class="product-actions">
                    <button class="btn-edit" onclick="editProduct('${product.id}')">
                        <i class="fas fa-edit"></i> تعديل
                    </button>
                    <button class="btn-delete" onclick="deleteProduct('${product.id}')">
                        <i class="fas fa-trash"></i> حذف
                    </button>
                </div>
            `;
            
            productsList.appendChild(productCard);
        }
        
function editProduct(productId) {
    db.collection('products').doc(productId).get()
        .then(doc => {
            if (doc.exists) {
                const product = doc.data();
                
                // تعبئة الحقول الأساسية
                productIdInput.value = product.id;
                productTitleInput.value = product.title;
                productCategoryInput.value = product.cat;
                productOldPriceInput.value = product.old;
                productPriceInput.value = product.price;
                productImageInput.value = product.img;
                
                // تعبئة الحقول الجديدة
                document.getElementById('productDescription').value = product.description || '';
                document.getElementById('productVideo').value = product.video || '';
                document.getElementById('productFeatures').value = (product.features || []).join('\n');
                
                // تفعيل وضع التعديل
                isEditMode = true;
                currentEditId = productId;
                formTitle.textContent = 'تعديل المنتج';
                submitBtn.innerHTML = '<i class="fas fa-save"></i> حفظ التغييرات';
                cancelEditBtn.classList.remove('hidden');
                productFormPanel.classList.add('edit-mode');
                
                productFormPanel.scrollIntoView({ behavior: 'smooth' });
            }
        })
        .catch(error => {
            showAlert('حدث خطأ في تحميل بيانات المنتج', 'error');
            console.error('Error loading product:', error);
        });
}
        
        // إلغاء التعديل
        cancelEditBtn.addEventListener('click', resetForm);
        
function resetForm() {
    productForm.reset();
    isEditMode = false;
    currentEditId = null;
    formTitle.textContent = 'إضافة منتج جديد';
    submitBtn.innerHTML = '<i class="fas fa-plus-circle"></i> إضافة المنتج';
    cancelEditBtn.classList.add('hidden');
    productFormPanel.classList.remove('edit-mode');
    
    // تفريغ الحقول الجديدة
    document.getElementById('productDescription').value = '';
    document.getElementById('productVideo').value = '';
    document.getElementById('productFeatures').value = '';
}
        // حذف المنتج
        function deleteProduct(productId) {
            if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                db.collection('products').doc(productId).delete()
                    .then(() => {
                        showAlert('تم حذف المنتج بنجاح', 'success');
                        loadProducts();
                    })
                    .catch(error => {
                        showAlert('حدث خطأ أثناء حذف المنتج', 'error');
                        console.error('Error deleting product:', error);
                    });
            }
        }
        
// تحديث الإحصائيات
function updateStats(total, ios, android, dvzoon) {
    totalProductsEl.textContent = total;
    iosProductsEl.textContent = ios;
    androidProductsEl.textContent = android;
    
    // تأكد من وجود عنصر DV ZOON
    const dvzoonEl = document.getElementById('dvzoonProducts');
    if (dvzoonEl) {
        dvzoonEl.textContent = dvzoon;
    }
}
        
        // عرض رسائل التنبيه
        function showAlert(message, type) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                ${message}
            `;
            
            alertContainer.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // ========== نظام إدارة الكوبونات ==========
        
// وظائف التبويبات
function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    document.querySelectorAll('.tab').forEach(btn => {
        btn.classList.remove('active');
    });
    
    document.getElementById(tabName + '-tab').classList.add('active');
    event.target.classList.add('active');
    
    if (tabName === 'coupons') {
        loadCoupons();
    } else if (tabName === 'payment') {
        console.log('Switching to payment tab...');
        setTimeout(() => {
            loadPaymentNumbers();
        }, 300);
    } else if (tabName === 'stats') {
        loadStats();
    }
}

        // تحميل الكوبونات
        function loadCoupons() {
            const couponsList = document.getElementById('couponsList');
            couponsList.innerHTML = '<div class="alert alert-warning">جاري تحميل الكوبونات...</div>';
            
            db.collection('coupons').orderBy('createdAt', 'desc').get()
                .then(querySnapshot => {
                    couponsList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        couponsList.innerHTML = '<div class="alert alert-warning">لا توجد كوبونات مضافة بعد</div>';
                        updateCouponStats(0, 0, 0);
                        return;
                    }
                    
                    let total = 0;
                    let active = 0;
                    let totalUsage = 0;
                    
                    querySnapshot.forEach(doc => {
                        const coupon = doc.data();
                        displayCoupon(coupon);
                        
                        total++;
                        if (coupon.isActive !== false) active++;
                        totalUsage += coupon.usedCount || 0;
                    });
                    
                    updateCouponStats(total, active, totalUsage);
                })
                .catch(error => {
                    console.error('Error loading coupons:', error);
                    couponsList.innerHTML = '<div class="alert alert-error">حدث خطأ في تحميل الكوبونات</div>';
                });
        }

        // عرض الكوبون
        function displayCoupon(coupon) {
            const couponCard = document.createElement('div');
            couponCard.className = 'coupon-card';
            
            const isActive = coupon.isActive !== false;
            const now = new Date();
            const startDate = coupon.startDate ? new Date(coupon.startDate) : null;
            const endDate = coupon.endDate ? new Date(coupon.endDate) : null;
            
            let status = 'active';
            let statusText = 'نشط';
            
            if (!isActive) {
                status = 'inactive';
                statusText = 'غير نشط';
            } else if (endDate && now > endDate) {
                status = 'expired';
                statusText = 'منتهي';
            } else if (startDate && now < startDate) {
                status = 'inactive';
                statusText = 'لم يبدأ';
            }
            
            const discountText = coupon.discountType === 'percent' ? 
                `${coupon.discountValue}%` : `${coupon.discountValue} جنيه`;
            
            couponCard.innerHTML = `
                <div class="coupon-header">
                    <div class="coupon-code">${coupon.code}</div>
                    <div class="coupon-discount">${discountText}</div>
                </div>
                <div class="coupon-details">
                    <span>النوع: ${coupon.discountType === 'percent' ? 'نسبة مئوية' : 'مبلغ ثابت'}</span>
                    <span>الحد: ${coupon.usageLimit || 'غير محدود'}</span>
                    <span class="coupon-status status-${status}">${statusText}</span>
                </div>
                ${coupon.startDate ? `<div style="color:var(--text-muted);font-size:12px;margin-top:5px;">من ${new Date(coupon.startDate).toLocaleDateString('ar-EG')}</div>` : ''}
                ${coupon.endDate ? `<div style="color:var(--text-muted);font-size:12px;">إلى ${new Date(coupon.endDate).toLocaleDateString('ar-EG')}</div>` : ''}
                <div class="coupon-stats">
                    <div class="stat-item">
                        <div class="stat-value">${coupon.usedCount || 0}</div>
                        <div class="stat-label">مرات الاستخدام</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${coupon.usageLimit ? Math.round(((coupon.usedCount || 0) / coupon.usageLimit) * 100) : '∞'}</div>
                        <div class="stat-label">نسبة الاستخدام</div>
                    </div>
                </div>
                <div class="coupon-actions">
                    <button class="btn-edit" onclick="editCoupon('${coupon.id}')">
                        <i class="fas fa-edit"></i> تعديل
                    </button>
                    <button class="btn-delete" onclick="deleteCoupon('${coupon.id}')">
                        <i class="fas fa-trash"></i> حذف
                    </button>
                </div>
            `;
            
            couponsList.appendChild(couponCard);
        }

        // إضافة كوبون جديد
        document.getElementById('couponForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const code = document.getElementById('couponCode').value.toUpperCase();
            const discountType = document.getElementById('discountType').value;
            const discountValue = parseFloat(document.getElementById('discountValue').value);
            const usageLimit = document.getElementById('usageLimit').value ? parseInt(document.getElementById('usageLimit').value) : null;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const isActive = document.getElementById('isActive').checked;
            
            const couponData = {
                id: Date.now().toString(),
                code: code,
                discountType: discountType,
                discountValue: discountValue,
                usageLimit: usageLimit,
                startDate: startDate || null,
                endDate: endDate || null,
                isActive: isActive,
                usedCount: 0,
                createdAt: new Date().toISOString()
            };
            
            db.collection('coupons').doc(couponData.id).set(couponData)
                .then(() => {
                    showAlert('تم إضافة الكوبون بنجاح', 'success');
                    this.reset();
                    loadCoupons();
                })
                .catch(error => {
                    showAlert('حدث خطأ أثناء إضافة الكوبون', 'error');
                    console.error('Error adding coupon:', error);
                });
        });

        // حذف الكوبون
        function deleteCoupon(couponId) {
            if (confirm('هل أنت متأكد من حذف هذا الكوبون؟')) {
                db.collection('coupons').doc(couponId).delete()
                    .then(() => {
                        showAlert('تم حذف الكوبون بنجاح', 'success');
                        loadCoupons();
                    })
                    .catch(error => {
                        showAlert('حدث خطأ أثناء حذف الكوبون', 'error');
                        console.error('Error deleting coupon:', error);
                    });
            }
        }

        // تحديث إحصائيات الكوبونات
        function updateCouponStats(total, active, usage) {
            document.getElementById('totalCoupons').textContent = total;
            document.getElementById('activeCoupons').textContent = active;
            document.getElementById('totalUsage').textContent = usage;
        }

    // تحميل الإحصائيات
function loadStats() {
    // إحصائيات المنتجات
    db.collection('products').get().then(snapshot => {
        document.getElementById('statsTotalProducts').textContent = snapshot.size;
        
        // حساب منتجات DV ZOON
        let dvzoonCount = 0;
        snapshot.forEach(doc => {
            if (doc.data().cat === 'dvzoon') {
                dvzoonCount++;
            }
        });
        
        const dvzoonEl = document.getElementById('statsDvzoonProducts');
        if (dvzoonEl) {
            dvzoonEl.textContent = dvzoonCount;
        }
    });
    
    // إحصائيات الكوبونات
    db.collection('coupons').get().then(snapshot => {
        document.getElementById('statsTotalCoupons').textContent = snapshot.size;
        
        let totalUsage = 0;
        snapshot.forEach(doc => {
            totalUsage += doc.data().usedCount || 0;
        });
        document.getElementById('statsTotalUsage').textContent = totalUsage;
    });
}

 // تحميل أرقام الدفع مع Real-time updates
function loadPaymentNumbers() {
    console.log('Loading payment numbers with real-time updates...');
    
    // Real-time listener للتحديثات الفورية
    db.collection('paymentNumbers').doc('current')
        .onSnapshot((doc) => {
            if (doc.exists) {
                const numbers = doc.data();
                console.log('Real-time update received:', numbers);
                
                // تحديث النماذج
                document.getElementById('binanceInput').value = numbers.binance || '01064061942';
                document.getElementById('vodafoneInput').value = numbers.vodafone || '01064061942';
                document.getElementById('freefireInput').value = numbers.freefire || '4587554173';
                document.getElementById('whatsappInput').value = numbers.whatsapp || '201064061942';
                
                // تحديث الإحصائيات - تأكد من وجود العناصر أولاً
                setTimeout(() => {
                    const binanceEl = document.getElementById('binanceNumber');
                    const vodafoneEl = document.getElementById('vodafoneNumber');
                    const freefireEl = document.getElementById('freefireNumber');
                    const whatsappEl = document.getElementById('whatsappNumber');
                    
                    if (binanceEl) binanceEl.textContent = numbers.binance || '01064061942';
                    if (vodafoneEl) vodafoneEl.textContent = numbers.vodafone || '01064061942';
                    if (freefireEl) freefireEl.textContent = numbers.freefire || '4587554173';
                    if (whatsappEl) whatsappEl.textContent = numbers.whatsapp || '201064061942';
                    
                    console.log('Stats updated:', {
                        binance: numbers.binance,
                        vodafone: numbers.vodafone,
                        freefire: numbers.freefire,
                        whatsapp: numbers.whatsapp
                    });
                }, 100);
            } else {
                console.log('No payment numbers document found');
                // إنشاء أرقام افتراضية إذا لم تكن موجودة
                const defaultNumbers = {
                    binance: '01064061942',
                    vodafone: '01064061942',
                    freefire: '4587554173',
                    whatsapp: '201064061942'
                };
                
                db.collection('paymentNumbers').doc('current').set(defaultNumbers)
                    .then(() => {
                        console.log('Default numbers created');
                    });
            }
        }, (error) => {
            console.error('Error in real-time listener:', error);
        });
}

// حفظ أرقام الدفع
document.getElementById('paymentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const numbers = {
        binance: document.getElementById('binanceInput').value.trim(),
        vodafone: document.getElementById('vodafoneInput').value.trim(),
        freefire: document.getElementById('freefireInput').value.trim(),
        whatsapp: document.getElementById('whatsappInput').value.trim(),
        updatedAt: new Date().toISOString(),
        updatedBy: auth.currentUser?.email || 'admin'
    };
    
    // تحقق من صحة الأرقام
    if (!numbers.binance || !numbers.vodafone || !numbers.freefire || !numbers.whatsapp) {
        showAlert('يرجى ملء جميع الحقول', 'error');
        return;
    }
    
    console.log('Saving payment numbers:', numbers);
    
    db.collection('paymentNumbers').doc('current').set(numbers, { merge: true })
        .then(() => {
            showAlert('تم حفظ أرقام الدفع بنجاح', 'success');
            console.log('Payment numbers saved successfully');
        })
        .catch(error => {
            showAlert('حدث خطأ أثناء حفظ الأرقام', 'error');
            console.error('Error saving payment numbers:', error);
        });
});

    </script>
</body>
</html>